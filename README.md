# Подготовительная программа по программированию на С/С++

## Домашнее задание №2

Дана программа в папке `project/src`.

Необходимо:
* Привести код программы в порядок
* Разобраться что программа делает
* Переписать программу используя несколько (хотя бы 2) модуля. Новая программа должна записывать в точности
	те же данные, что записывала исходная программа
* Для того, чтобы убедиться, что программа работает правильно, реализовать тест, который проверяет
успешность записи/перезаписи данных на диске (тоже в отдельном модуле).

Пример кода теста:

Основной модуль:
```c
void write_to_file(const char *filename, struct some *data);
void read_from_file(const char *filename, struct some *data);
```

Код теста
```c
#include "main_module.h"

void test_write_to_file() {
	const char *filename = "....";

	struct some expected_data;
	// Fill `expected_data` with some test values
	// and write them into the file `f`.
	// ...
	write_to_file(filename, &expected_data);

	struct some got_data;
	read_from_file(filename, &got_data);

	// Compare any field from `expected_data` with any field from `got_data`
	// ....
}
```

Критерии оценки:
За ДЗ можно получить до 2 баллов.
+1 балл за:
- выполнение всех основных требований, включая написание теста. Важно, тест должен не просто быть написан, но и запускаться и проходить на CI. На CI все проверки должны проходить;
- логика исходной программы поменяться не должна;
- тест должен проверять работу основной программы, а не отдельно реализованных только для теста структур и функций;
- имена всех типов, функций и переменных понятные. Не используются странные сокращения или ни о чём не говорящие слова вида blackrecord. Например, названия функций содержат в себе глагол как основное слово;
- все переменные определяются с новой строки, инициализация совмещена с определением, само определение расположено как можно ближе к точке использования, соблюдается единый стиль кодирования (в частности, sneak_case + имена с маленькой буквы, а типы - с _t на конце);
- файлы называются понятно и полностью отражают суть функций, которые в них содержатся. Для функций тоже должен выполняться принцип единственной ответственности;
- проверяется результат работы scanf, не только на EOF, но и на количество успешно считанных аргументов. Ошибочные ситуации корректно обрабатываются, не нарушая исходной логики программы;
- во всех функциях проверяется корректность входных аргументов;
- нет копипасты (например, не дублируется код приглашения ввода), всё вынесено в отдельные функции.

+1 балл за:
- все захардкоженные константы, включая размер массивов, вынесены в enum;
- форматные строки scanf и printf формируются динамически, на основе передачи размера поля через аргумент, равный значению enum-константы (с использованием функции snprintf и динамических спецификаторов * в форматной строке). Логика формирования форматных строк также разбита на функции;
- функция main разбита на несколько функций. Во всех функциях выполняется принцип единственной ответственности. Например, не должно быть функции, которая одновременно что-то считывает и распечатывает (если это не функция-диспетчер, чья задача вызвать эти функции в правильном порядке). Другой пример - функция записи в файл не должна ничего попутно выводить в stdout. Вообще, про существование stdin/stdout может знать только функция main;
- помимо интеграционного теста написаны отдельные тесты для проверки основных функций программы (например, отдельно - функции записи, и отдельно - функции чтения). Тесты успешно запускаются и проходят на CI.
